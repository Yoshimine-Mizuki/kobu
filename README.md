# 鼓舞Webサイト開発マニュアル
## 概要
鼓舞のWebサイトを開発する際の手順について記載しています。

手順に変更があった場合は、このREADME.mdに追記をお願いします。

210905 ミリオン

## ディレクトリ構造
鼓舞のWebサイトのディレクトリ構造です。

各ページを開発する際は、以下のディレクトリ内のファイルを編集してください。

新規でファイルを追加した場合は、必要に応じてディレクトリ構造を更新してください。

```
kobu/
├── 404/ : 要求されたファイルが見つからない場合に表示されるページ
├── About/「鼓舞とは」のページ
├── Contact/ : 「お問い合わせ」ページ
├── Info/ : 「お知らせ」ページ
├── Link/ : 「リンク」ページ
├── OBOG/
│   ├── apparatus.html : 「装置チェック」ページ
│   ├──  index.html : 認証用ページ
│   ├── onbunote.html : 「団員専用ページ」
│   └── apparatus_db.json : 「装置チェック」データベース
├── Performances/ : 「舞台紹介」ページ
├── Programs/ : 「演目紹介」ページ
├── resources/
│   ├── css/style.css : スタイルシート
│   ├──  images/ : 画像格納ディレクトリ
│   ├── data.json : 演目紹介の文章
│   └── info.json : お知らせの文章
└── index.html : トップページ
```

## 開発について
以下のような場合、鼓舞のWebサイトの開発を行います。

* 新歓・公演がある場合に「お知らせ」ページの編集
* 公演を行った場合に「舞台紹介」ページの編集
* レパの追加・廃止の場合に「演目紹介」ページの編集
* 不具合修正
* その他

## 開発手順
以下、Webサイト開発時の手順です。特にチームで開発を行うときは、この手順に沿って開発を行ってください。

1. 新規承認
2. issue作成
3. 開発
4. MR・ソースチェック
5. リリース

### 1. 新規承認
開発を行う前に、LINEグループなどで開発について周知し、他のメンバーから承認を得てください。

### 2. issue作成
開発の承認が得られたらGitlab上でissueを作成してください。issueの作成は以下のテンプレートに従ってください。

```
Title : #{issue番号}: {開発のタイトル}
Type : issue
Description : {開発の概要・仕様}
```

{issue番号}は00001から5桁の連番でつけてください。そのほかは基本的に指定しなくて大丈夫です。

### 3. 開発
開発を行います。開発を行う前に必ずmasterブランチを最新にしてください。

```
$ git co master
$ git pull
```

ブランチは以下の通り作成してください。

```
developブランチ(devブランチ) : dev/{issue番号}
featureブランチ(featブランチ) : feat/{さ名}/{issue番号}
```

devブランチはチームで開発を行う場合必ず作成し、作成後すぐpushして、マージリクエスト(MR)を作成してください。MRを作成したら、MRのURLをissueのdescriptionに追記してください。MRの作成方法は4で解説しています。

```
$ git co -b dev/{issue番号}
$ git push origin dev/{issue番号}
$ git co -b feat/{さ名}/{issue番号}
```

コードの編集はディレクトリ構造を参考にしてください。新しいディレクトリやファイルを作成した場合、ディレクトリ構造に追記してくでさい。スタイルはresources/css/style.cssを編集、画像はresources/imagesに追加してください。

コードの編集が完了したらリモートリポジトリへpushしてください。以下、プロジェクトのルートディレクトリで実行してください。

```
$ git add .
$ git ci -m "#{isuue番号} {コミットメッセージ}"
$ git push origin {ブランチ名}
```

{コミットメッセージ}は、コミットの内容を具体的に記述してください、

コミットメッセージ例:
#00001 マニュアルの追記

### 4. MR・ソースチェック
担当の開発全体が完了しコードをpushできたら、MRを作成してください。

1. New…(Search Gitlabの左の+ボタン) → New marge request
2. Select source branchから作成したブランチを選択し(devブランチがある場合は、Target branchをmasterからdevに変更)、Compare branches and continueをクリック
3. Titleはissueタイトル、必要に応じてDescriptionに開発概要を記述し、Changesタブから自分の編集したコードが正しいか確認し、Create merge requestをクリック

MRの作成が完了したら他のメンバーにURLを共有し、ソースチェックを行ってください。ソースチェックが完了したら権限のある人がMRをApproveしてください。

### 5. リリース
Approveした人が、FTPソフトなどを利用してで鼓舞のサイトにファイルをアップロードしてください。

|    |    |
| :- | :- |
| ホスト名 | sftp://www2.jimu.nagoya-u.ac.jp |
| ユーザ名 | minzokuonbu |
| パスワード | tekka2427 |

これで、開発は完了です。

<!-- 以下、旧マニュアル -->

# 23888_08_音舞HP管理マニュアル改訂.doc

## スカパーの簡単ＨＰ操作表＾－＾100404　　→追記てんてん　120209

### ＦＦＦＴＰ内操作

- ＨＴＭＬ・・・主に文章を変えたいときに使用

<!-- これ以下のやつは見ればわかると思います。 -->
### 頻繁に使うTOPページの変更について

トップページを押し、主に使うのがmigi.html

migi.htmlはＨＰ上での右の画面。トップ背景や、文字、更新情報、
重要なリンク貼り付けなどをやります。

<!-- 次に変え方を紹介するよ！ -->
### ページ変更の仕方
#### 背景をマスターすればだいたい分かるので・・・背景編

1. つけたい画像を名前を付けて保存

    ↓（ＨＰ係資料USB素材にも保存）
2. ＦＦＦＴＰで素材をアップロード

    ↓
3. ＨＴＭＬ

    ↓
4. トップページ

    ↓
5. migi.htmlを右クリックしてnotepadを開く

    ↓
6. 画像のプログラムを変更して上書き保存

    ↓
7. migi.htmlを右クリックしてアップロード

### 俺が今日気付いたこと（笑）

新歓ページを変更したいときはＦＦＦＴＰの右側の部分を新歓関連を開いた状態で左側
をアップロードすれば正常にＨＰにUPされます。

とにかく慣れですね(⌒\_⌒;

前の係の人に聞けば大丈夫です！

すごいＨＰ作ろー＾－＾

下に載ってるのは俺も分からない先輩が書いたものです！（笑）

**音舞HP管理マニュアル(暫定)**


---
すんません。続きは余裕を見て作ります(>人\<)

\[よく使われるファイル\]

index.htm　　：トップページでフレームのベースになっているファイル。直接は見えないけど、この上にmigi.htmと
hidari.htmがのっている。

migi.htm　　 ：トップのメイン。

　ob.htm　　　　：ＯＢＯＧ会のページ

hidari.htm　
：トップページの左側フレーム。メニューを変更するときなど。画像ファイルは「topicon」フォルダ。

> 以下のファイルはトップからのリンクページ。enmoku以外は初期ページのhtmファイルが使われてる。

　hajime.htm　　：始めに

　what.htm　　　：音舞とは？

　member.htm　　：団員紹介

　ayumi.htm　　 ：舞台紹介

　enmoku.htm　　：演目紹介　このファイルだけは「html」フォルダ内にある

　tsunagari.htm ：リンク

　contact.htm　 ：お問い合わせ

活動予定日、掲示板、ブログ、アルバムは直接webページにとぶため、htmファイルはない。

member○○(入団年度).htm

> ：団員紹介の各回生のページ。画像ファイルは「danin」フォルダにある。

butai1.htm　 ：舞台紹介の最新ページ。butai.htmはすかい舞台のページ笑

e-演目名.htm
：演目紹介の各ページ。いたるところに同名ファイルがあるが、今使われているのは、「html」フォルダに入っているやつ。使われている写真ファイルは、「repa」フォルダに入っているやつ。

<!-- \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-- -->

---
団員紹介の更新

基本的に前のやつのコピペ。

枠の数を合わせたり、色を変えたり、文を変えたりと調整が多いけどがんばー！

画像ファイルを「danin」フォルダにアップして、指定先を変えればOK

<!-- \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-- -->

---
舞台紹介の更新

コピペで新しいファイル作る、からのリンク先変更でOK

<!-- \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-- -->

---
演目紹介の写真の差し替え

1. まず写真を選ぶ。１レパ４枚！

1. 写真デカイから小さくしとくといい。だいたい400×300もあれば十分。

　　オススメのフリーソフトはJtrim。一括変換できるよ。

http://www.gigafree.net/tool/retouch/jtrim.html

1. 写真ファイルの名前を、「10m haneko1.jpg」のように、

　　年度、名大祭期(m)or定演期(t)、半角スペース、演目、数字(1～4)、.jpg

　　のファイル名で保存しておく。例では、2010年度名大祭期はねこ1枚目の写真。

　　レパ名のローマ字表記などは「repa」フォルダ参照。

1. すべて写真ファイルを「repa」にアップロード

1. 「html」フォルダのe-演目名.htmをnotepadで開く。

1. 上のメニュー、編集→置換で、期の部分だけ変更する。

　　例えば、10mを10tに置換する。

注：mをtに置換する場合、「10m momi1.htm」は「10t
toti1.htt」になってしまう。

　　必ず10mから10tに指定すべし。

1. 写真４枚分置換したら保存、アップロード

HPで変更を確認しましょう。

この画像ファイルの差し替えを置換で行う方法は、団員紹介でも応用可能でしょう！！

---
1. ファイル転送

    「FFFTP」というフリーソフトを使うと更新作業が楽です

    HTMLファイルの拡張子はhtmで統一して下さい。

    　画像ファイルの拡張子は極力bmpは避けて、jpgにしよう。

  **ホスト情報**

  |    |    |
  | :- | :- |
  | ホスト名 | sftp://www2.jimu.nagoya-u.ac.jp|
  | ユーザ名 | minzokuonbu |
  | パスワード | tekka2427 |

2. 予定表

   現在HPにある書き込み式の予定表は3代目管理人である「部長」の個人スペースを利用させてもらっています

   今後も使用してもいいし、不必要だと感じたら削除してください

   その際は必ず連絡を入れるようにしてください　⇒　<rabbit@kiwi.ne.jp>

3. 掲示板

   名大のサーバーはcgiをアップロードすることができないのでFC2のサービス使っています

   記事の削除等は管理人の判断でお願いします

   キウチスポーツさんの宣伝カキコは削除しないでください

| ログイン情報 |    |
| :- | :- |
| メールアドレス | onbuhpkakari\@yahoo.co.jp |
| パスワード | onbumail |
| 登録メールアドレス | 1： felicem-diem-omnem.83366x\@ezweb.ne.jp (てんてん) |
| | 2： y-3.iky-tmdcnut\@docomo.ne.jp　(薺) |

秘密の質問は基本的にオレのサ名でOK

1. ブログ

   頻繁ではないが問い合わせ(主に依公の依頼)が届くことがあります

   そのため管理人は個人のアドレスを使うなどしてメールを管理しなければいけません

| ログイン情報 | |
| :- | :- |
| ID | otonimau |
| パスワード | hpadmin |

5. メール

   頻繁ではないが問い合わせ(主に依公の依頼)が届くことがあります

   そのため管理人は個人のアドレスを使うなどしてメールを管理しなければいけません

6. ページの更新

   基本的に管理人が好きなように更新すればいいです

   レイアウトをすべて書き換えても全然問題はありません

   各団体に許されたサーバースペースは40MBみたいです

   →今73MB使ってます笑。たぶんフォルダに分割していれば大丈夫っぽい？？フォルダの外にあるファイルだけならまだ8MBくらい。

   →でもファイル整理とか定期的にするべきかも。もう使われてない写真ファイルの整理とか

   そのためにもFFFTPでフォルダわけをしておくとわかりやすいし、一括削除が楽だね。引継ぎ後もわかりやすいフォルダにしましょ。

フォルダを作る場合、

```html
<a href="○○○.htm">

<img src="○○○.jpg">
```

とかで、いつもはリンクや画像の指定先ファイルを直接「\"」ではさんでいたけども、

フォルダの中のリンクや画像を指定する場合、

```html
<a href="/minzokuonbu/フォルダ名/○○○.htm">

<img src="/minzokuonbu/フォルダ名/○○○.jpg">
```

というように、「/」ではさんでフォルダも指定します。

例えば、hidari.htmでは、

```html
<a href="hajime.htm" title=このＨＰのお約束・ご案内>

<img src="/minzokuonbu/topicon/ougi.JPG" height="45" border=0></a>
```
っていうタグがあると思うんだけど、

これは「topicon」フォルダ内のougi.JPGて画像を指定しているということ。

このとき、FFFTPの初期ページにougi.JPGがアップロードされてても読み取りません。

/minzokuonbu/の部分は、フォルダ内のリンクや画像を指定するとき以外(初期ページにアップロードされてるファイルの指定のとき)は省略できるみたい。でも、そうじゃないときも省略できるのかも･･･？

ちなみに今現在、「メニュー一覧」フォルダには各ページのリンクのhtm　(ayumi.htmやcontact.htm)が入っているけどあれは使われてないみたい。

で、初期ページにも別のayumi.htmやcontact.htm(ファイルの名前は同じだけど、背景がついてたりする別のファイルたち)があって、hidari.htmからはそっちにリンク先指定してるよ。(上の例でも直接hajime.htmを指定してるからフォルダ指定のタグがない。)この辺とか整理してくれんかなー笑

「『演目紹介』と『定演History』は2代目管理人が気合を入れて作ってくれたものです。完成度が高いのでリニューアルするとしても何らかの形で残しておくといい」でしょう

　現在のページレイアウトは5代目管理人、ページソースは6代目管理人によるものです。完成度はずいぶんいいと思います。さぁ、あなたはこれ以上のものを作れるか？

　「依公News online
ver.」は5代目管理人が渉外局の提案で作成し始めたものですが、ぶっちゃけ停滞していますので更新するか削除して欲しいです(他人任せ)

7. 管理人の仕事とやって欲しいこと

   - お問い合わせ先のメールアドレスを変更
   - メールチェックして適切な人に転送
   - 掲示板の荒らしの削除
   - ページの更新とボリュームアップ
   - 携帯サイトの運営
   - 毎月の掲示板の背景画像の変更
   - ブログの管理
   - 団員紹介の更新
   - 舞台紹介の追加
   - 演目紹介の写真の差し替え

引継ぎ作業での注意点(携帯への転送先等)

自動返信の更新

8. ＨＰ係の仕事たち！

   - 団員紹介の更新

      基本的に前のやつのコピペ。

      枠の数を合わせたり、色を変えたり、文を変えたりと調整が多いけどがんばー！

      画像ファイルを「danin」フォルダにアップして、指定先を変えればOK

   - 舞台紹介の更新

      コピペで新しいファイル作る、からのリンク先変更でOK

   - 演目紹介の写真の差し替え

     1. まず写真を選ぶ。１レパ４枚！

     2. 写真デカイから小さくしとくといい。だいたい400×300もあれば十分。

        オススメのフリーソフトはJtrim。一括変換できるよ。

        http://www.gigafree.net/tool/retouch/jtrim.html

     3. 写真ファイルの名前を、「10m haneko1.jpg」のように、

         　　年度、名大祭期(m)or定演期(t)、半角スペース、演目、数字(1～4)、.jpg

         　　のファイル名で保存しておく。例では、2010年度名大祭期はねこ1枚目の写真。

         　　レパ名のローマ字表記などは「repa」フォルダ参照。

     2. すべて写真ファイルを「repa」にアップロード

     3. 「html」フォルダのe-演目名.htmをnotepadで開く。

     4. 上のメニュー、編集→置換で、期の部分だけ変更する。

         　　例えば、10mを10tに置換する。

         注：mをtに置換する場合、「10m momi1.htm」は「10t
         toti1.htt」になってしまう。

         　　必ず10mから10tに指定すべし。

     5. 写真４枚分置換したら保存、アップロード

      webからHPに行って変更を確認しましょう。

      この画像ファイルの差し替えを置換で行う方法は、団員紹介でも応用可能でしょう！！

   - お問い合わせフォームからのメールを、新HP係の携帯に知らせる設定

FC2のメールフォームツールを使ってます。FC2のIDは下のやつ。

**ログイン情報**

ID：onbuhpkakari\@yahoo.co.jp

パス：onbumail

ブログとは別のIDです！秘密の質問は基本的にオレのサ名でOK

１：yahooメールにログイン

２：右上、「メールの設定」

３：「フィルター設定」

４：「通知先メールアドレスの登録/選択はこちら」

５：モバイル用メールアドレスを追加するには、「こちら」から設定してください。

６：パス再確認

７：\[メールアドレスを追加\]

８：新HP係の携帯アドレスを入力、決定、編集終了

９：携帯に送られるメールから承認

10：受信通知の設定(前のページ)で、携帯端末の選択肢から、新HP係のアドレスを選択、保存

一応HPのメールフォームからテストメール送ってみるといいよ。届くまでに時間のラグがかなりあるけども。

↓↓↓薺↓↓↓

2012.06.28　Googleアカウント作成

名前　民族舞踊団　音舞

ユーザー名　<onbuhpkakari12@gmail.com>

パスワード　onbumail

生年月日　　1991.11.05

性別　　女性

携帯番号 090-4791-1873

メールアドレス　<y-3.iky-tmdcnut@docomo.ne.jp>

↑を用いて、FC2のアカウントをもう一つ獲得

ニックネーム　音舞

パスワード　　hpadmin

秘密の質問　　母の出生地

答え　　　　　大垣市

誕生日　　　　19911105

郵便番号　　　4660811

FC2ブログのアカウント

ログインの仕方は

メールアドレス／ID　<onbuhpkakari12@gmail.com>

パスワード　　　　　hpadmin

だよ！

このアドレスで使うFC2のサービス

- ブログ

- 動画

- ホームページ

　　➥URL http://minzokuonbu.web.fc2.com/

PASS otonimau2012

- 掲示板

　　➥ID　 otonimau12

Google :

ユーザー名　<onbuhpkakari12@gmail.com>

パスワード　onbumail

Twitter:

Id : \@onb_u\_2nd

Pass : onbumail
